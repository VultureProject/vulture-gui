{% extends "layout2.html" %}
{% load i18n %}
{% load static %}

{% block css_include %}

{% endblock %}

{% block js_include %}
  <script src="{% static 'js/listener.js' %}"></script>
{% endblock %}

{% block content %}

  <section class="content">
    <form id="frontend_edit_form" class="form-horizontal bootstrap-validator-form" action="{% url 'services.frontend.edit' object_id %}" method="post" novalidate="novalidate">
      {% csrf_token %}
      <div class="row">
        <div class="col-md-12">
          {% if save_error or form.non_field_errors %}
          <div class="panel panel-danger">
            <div class="panel-heading">
              {# If there is save/configuration errors #}
              {% if save_error %}
                <ul class="nav nav-tabs pull-right ui-sortable-handle">
                  <li class="active"><a href="#tab_1" data-toggle="tab">{% translate "Message" %}</a></li>
                  <li><a href="#tab_2" data-toggle="tab">{% translate "Advanced informations" %}</a></li>
                </ul>
                <h4 class="panel-title">{% translate "Configuration error" %}</h4>
              {% endif %}
              {% if form.non_field_errors %}
                <h4 class="panel-title"><i class="icon fa fa-ban"></i> {% translate "Form errors" %} </h4>
              {% endif %}
            </div>
            <div class="panel-body">
              {# Print form errors correctly #}
              {% if form.non_field_errors %}
                <div>
                  {{ form.non_field_errors|safe }}
                </div>
              {% endif %}
              {# If there is save/configuration errors #}
              {% if save_error %}
                <div>
                  <div class="tab-content no-padding">
                    <div class="tab-pane active" id="tab_1">
                      <pre class="console-type">{{ save_error.0 }}</pre>
                    </div>
                    <div class="tab-pane" id="tab_2">
                      <pre class="console-type">{{ save_error.1 }}</pre>
                    </div>
                  </div>
                </div>
              {% endif %}
            </div>
          </div>
          {% endif %}
          <div class="panel">
            <div class="panel-body">
              <div class="nav-tabs-custom nav-tabs-no-margin">
                <ul class="nav nav-tabs">
                  <li class="active"><a href="#tab_general" data-toggle="tab">{% translate "General" %}</a></li>
                  <li><a href="#tab_network" data-toggle="tab" class="network-mode">{% translate "Listeners" %}</a></li>
                  <li><a href="#tab_log_settings" data-toggle="tab" class="api-mode filebeat-mode">{% translate "LOG Settings" %}</a></li>
                  <li><a href="#tab_http" data-toggle="tab" class="http-mode">{% translate "HTTP Options" %}</a></li>
                  <li><a href="#tab_headers" data-toggle="tab" class="http-mode">{% translate "HTTP Headers" %}</a></li>
                  <li><a href="#tab_enrichment" data-toggle="tab" class="logging">{% translate "Logs Enrichment" %}</a></li>
                  <li><a href="#tab_logging" data-toggle="tab" class="logging">{% translate "Logs Forwarder" %}</a></li>
                  <li><a href="#tab_custom_rsyslog" data-toggle="tab" class="logging">{% translate "Custom operations" %}</a></li>
                  <li><a href="#tab_custom_haproxy" data-toggle="tab" class="haproxy-conf">{% translate "Custom conf" %}</a></li>
                </ul>
                <div class="tab-content">
                  <br/>
                  <div class="tab-pane active" id="tab_general">
                    <div class="row">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Enable listener" %}</label>
                          <div class="col-sm-5">
                            {{form.enabled}}
                            {{form.enabled.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row -->
                    <div class="row">
                      <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{% translate "Friendly name" %}</label>
                            <div class="col-sm-5">
                              {{form.name}}
                              {{form.name.errors|safe}}
                            </div>
                          </div>
                      </div>
                    </div> <!-- /.row -->
                    <div class="row">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Mode" %}</label>
                          <div class="col-sm-5">
                            {{form.mode}}
                            {{form.mode.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row -->
                    <div class="row http-mode tcp-mode log-mode filebeat-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Enable logging" %}</label>
                          <div class="col-sm-5">
                          {{form.enable_logging}}
                          {{form.enable_logging.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row http-mode tcp-mode log-mode filebeat-mode -->
                    <div class="row http-mode-logging">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Log level" %}</label>
                          <div class="col-sm-5">
                            {{form.log_level}}
                            {{form.log_level.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row http-mode-logging -->
                    <div class="row http-mode-logging tcp-mode-logging">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Store logs into cluster database" %}</label>
                          <div class="col-sm-5">
                            <input type="checkbox" class="js-switch" id="stock_logs_locally"/>
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row http-mode-logging -->
                    <div class="row logging">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Archive logs on system" %}</label>
                          <div class="col-sm-5">
                            <input type="checkbox" class="js-switch" id="archive_logs"/>
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row logging -->
                    <div class="row log-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Rsyslog Listening mode" %}</label>
                          <div class="col-sm-5">
                            {{form.listening_mode}}
                            {{form.listening_mode.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row log-mode -->
                    <div class="row filebeat-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Filebeat Module" %}</label>
                          <div class="col-sm-5">
                            {{form.filebeat_module}}
                            {{form.filebeat_module.errors|safe}}
                          </div>
                        </div>
                      </div>
                      <div class="col-md-12" id="filebeat-input-div">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Filebeat Input" %}</label>
                          <div class="col-sm-5">
                            {{form.filebeat_listening_mode}}
                            {{form.filebeat_listening_mode.errors|safe}}
                          </div>
                        </div>
                      </div>
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Filebeat Configuration" %}</label>
                          <div class="col-sm-5">
                            {{form.filebeat_config}}
                            {{form.filebeat_config.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row filebeat-mode -->
                    <div class="row log-mode filebeat-mode" id="ruleset-div">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Input logs type" %}</label>
                          <div class="col-sm-5">
                            {{form.ruleset}}
                            {{form.ruleset.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row log-mode filebeat-mode -->
                    <div class="row log-mode filebeat-mode forwarder-tag">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.parser_tag.label }}</label>
                          <div class="col-sm-5">
                            {{form.parser_tag}}
                            {{form.parser_tag.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row log-mode filebeat-mode -->
                    <div class="row log-mode filebeat-mode" id="node-div">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.node.label }}</label>
                          <div class="col-sm-5">
                            {{form.node}}
                            {{form.node.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row log-mode filebeat-mode -->
                    <div class="row log-mode file-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.file_path.label }}</label>
                          <div class="col-sm-5">
                            {{form.file_path}}
                            {{form.file_path.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row log-mode -->
                    <div class="row log-mode kafka-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.kafka_brokers.label }}</label>
                          <div class="col-sm-5">
                            {{form.kafka_brokers}}
                            {{form.kafka_brokers.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row log-mode -->
                    <div class="row log-mode kafka-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.kafka_topic.label }}</label>
                          <div class="col-sm-5">
                            {{form.kafka_topic}}
                            {{form.kafka_topic.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row log-mode -->
                    <div class="row log-mode kafka-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.kafka_consumer_group.label }}</label>
                          <div class="col-sm-5">
                            {{form.kafka_consumer_group}}
                            {{form.kafka_consumer_group.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row log-mode -->
                    <div class="row log-mode kafka-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.kafka_options.label }}</label>
                          <div class="col-sm-5">
                            {{form.kafka_options}}
                            {{form.kafka_options.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row log-mode -->
                    <div class="row filebeat-mode redis-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">Use local Redis</label>
                          <div class="col-sm-5">
                            {{form.redis_use_local}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row filebeat-mode redis-mode -->
                    <div class="row filebeat-mode redis-mode redis-connect">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.redis_server.label }}</label>
                          <div class="col-sm-5">
                            {{form.redis_server}}
                            {{form.redis_server.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row filebeat-mode redis-mode redis-connect -->
                    <div class="row filebeat-mode redis-mode redis-connect">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.redis_port.label }}</label>
                          <div class="col-sm-5">
                            {{form.redis_port}}
                            {{form.redis_port.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row filebeat-mode redis-mode redis-connect -->
                    <div class="row redis-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.redis_mode.label }}</label>
                          <div class="col-sm-5">
                            {{form.redis_mode}}
                            {{form.redis_mode.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row redis-mode -->
                    <div class="row redis-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{ form.redis_key.label }}</label>
                          <div class="col-sm-5">
                            {{form.redis_key}}
                            {{form.redis_key.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row redis-mode -->
                    <div class="row">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Tags" %}</label>
                          <div class="col-sm-5">
                            {{form.tags}}
                            {{form.tags.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row -->
                    <div class="row">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Darwin policies" %}</label>
                          <div class="col-sm-5">
                            {{form.darwin_policies}}
                            {{form.darwin_policies.errors|safe}}
                          </div>
                        </div>
                      </div>
                      <div class="darwin-mode">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{% translate "Darwin mode" %}</label>
                            <div class="col-sm-5">
                              {{form.darwin_mode}}
                              {{form.darwin_mode.errors|safe}}
                            </div>
                          </div>
                        </div>
                      </div> <!-- /.row darwin-mode -->
                    </div> <!-- /.row -->
                    <!-- Advanced tab -->
                    <div class="row log-mode filebeat-mode">
                      <div class="col-sm-4 pull-right">
                        <div class="form-group">
                          <button class="btn btn-box-tool" type="button" data-toggle="collapse" data-target=".advanced_options">
                            <i class="fa fa-plus"></i> {% translate "Advanced" %}
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="form-group collapse advanced_options">
                      <div class="row filebeat-mode redis-mode redis-connect">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{{ form.redis_password.label }}</label>
                            <div class="col-sm-5">
                              {{form.redis_password}}
                              {{form.redis_password.errors|safe}}
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row filebeat-mode redis-mode redis-queue-mode">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{{ form.redis_batch_size.label }}</label>
                            <div class="col-sm-5">
                              {{form.redis_batch_size}}
                              {{form.redis_batch_size.errors|safe}}
                            </div>
                          </div>
                        </div>
                      </div>
                      <div id="redis-settings">
                        <div class="row redis-mode redis-queue-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{ form.redis_use_lpop.label }}</label>
                              <div class="col-sm-5">
                                {{form.redis_use_lpop}}
                                {{form.redis_use_lpop.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row redis-mode redis-stream-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{ form.redis_stream_startID.label }}</label>
                              <div class="col-sm-5">
                                {{form.redis_stream_startID}}
                                {{form.redis_stream_startID.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row redis-mode redis-stream-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{ form.redis_stream_consumerGroup.label }}</label>
                              <div class="col-sm-5">
                                {{form.redis_stream_consumerGroup}}
                                {{form.redis_stream_consumerGroup.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row redis-mode redis-stream-mode redis-consumer-group">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{ form.redis_stream_consumerName.label }}</label>
                              <div class="col-sm-5">
                                {{form.redis_stream_consumerName}}
                                {{form.redis_stream_consumerName.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row redis-mode redis-stream-mode redis-consumer-group">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{ form.redis_stream_acknowledge.label }}</label>
                              <div class="col-sm-5">
                                {{form.redis_stream_acknowledge}}
                                {{form.redis_stream_acknowledge.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row redis-mode redis-stream-mode redis-consumer-group">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{ form.redis_stream_reclaim_timeout.label }}</label>
                              <div class="col-sm-5">
                                {{form.redis_stream_reclaim_timeout}}
                                {{form.redis_stream_reclaim_timeout.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row listening-tcp">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{{form.healthcheck_service.label}}</label>
                            <div class="col-sm-5">
                              {{form.healthcheck_service}}
                              {{form.healthcheck_service.errors|safe}}
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row log-mode filebeat-mode">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{% translate "Size of mmdblookup cache" %}</label>
                            <div class="col-sm-5">
                              {{form.mmdb_cache_size}}
                              {{form.mmdb_cache_size.errors|safe}}
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row log-mode">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{{form.queue_type.label}}</label>
                            <div class="col-sm-5">
                              {{form.queue_type}}
                              {{form.queue_type.errors|safe}}
                            </div>
                          </div>
                        </div>
                      </div>
                      <div id="tab-queue">
                        <div class="row log-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{form.queue_size.label}}</label>
                              <div class="col-sm-5">
                                {{form.queue_size}}
                                {{form.queue_size.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row log-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{form.dequeue_batch_size.label}}</label>
                              <div class="col-sm-5">
                                {{form.dequeue_batch_size}}
                                {{form.dequeue_batch_size.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row log-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{form.nb_workers.label}}</label>
                              <div class="col-sm-5">
                                {{form.nb_workers}}
                                {{form.nb_workers.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row log-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{form.new_worker_minimum_messages.label}}</label>
                              <div class="col-sm-5">
                                {{form.new_worker_minimum_messages}}
                                {{form.new_worker_minimum_messages.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row log-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{form.light_delay_mark.label}}</label>
                              <div class="col-sm-5">
                                {{form.light_delay_mark}}
                                {{form.light_delay_mark.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row log-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{form.full_delay_mark.label}}</label>
                              <div class="col-sm-5">
                                {{form.full_delay_mark}}
                                {{form.full_delay_mark.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row log-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{form.shutdown_timeout.label}}</label>
                              <div class="col-sm-5">
                                {{form.shutdown_timeout}}
                                {{form.shutdown_timeout.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row log-mode">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="col-sm-4 control-label">{{form.enable_disk_assist.label}}</label>
                              <div class="col-sm-5">
                                {{form.enable_disk_assist}}
                                {{form.enable_disk_assist.errors|safe}}
                              </div>
                            </div>
                          </div>
                        </div>
                        <div id="tab-disk">
                          <div class="row log-mode">
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="col-sm-4 control-label">{{form.save_on_shutdown.label}}</label>
                                <div class="col-sm-5">
                                  {{form.save_on_shutdown}}
                                  {{form.save_on_shutdown.errors|safe}}
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row log-mode">
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="col-sm-4 control-label">{{form.low_watermark.label}}</label>
                                <div class="col-sm-5">
                                  {{form.low_watermark}}
                                  {{form.low_watermark.errors|safe}}
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row log-mode">
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="col-sm-4 control-label">{{form.high_watermark.label}}</label>
                                <div class="col-sm-5">
                                  {{form.high_watermark}}
                                  {{form.high_watermark.errors|safe}}
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row log-mode">
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="col-sm-4 control-label">{{form.max_file_size.label}}</label>
                                <div class="col-sm-5">
                                  {{form.max_file_size}}
                                  {{form.max_file_size.errors|safe}}
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row log-mode">
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="col-sm-4 control-label">{{form.max_disk_space.label}}</label>
                                <div class="col-sm-5">
                                  {{form.max_disk_space}}
                                  {{form.max_disk_space.errors|safe}}
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row log-mode">
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="col-sm-4 control-label">{{form.checkpoint_interval.label}}</label>
                                <div class="col-sm-5">
                                  {{form.checkpoint_interval}}
                                  {{form.checkpoint_interval.errors|safe}}
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row log-mode">
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="col-sm-4 control-label">{{form.spool_directory.label}}</label>
                                <div class="col-sm-5">
                                  {{form.spool_directory}}
                                  {{form.spool_directory.errors|safe}}
                                </div>
                              </div>
                            </div>
                          </div>
                        </div> <!-- /.tab-disk -->
                      </div> <!-- /.tab-queue -->
                      <div class="row log-mode listening-tcp">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{% translate "Disable 'Octet-counted framing'" %}</label>
                            <div class="col-sm-5">
                              {{form.disable_octet_counting_framing}}
                              {{form.disable_octet_counting_framing.errors|safe}}
                            </div>
                          </div>
                        </div>
                      </div> <!-- /.row log-mode listening-tcp -->
                      <div class="row log-mode listening-tcp">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{% translate "Additional Frame Delimiter (AddtlFrameDelimiter)" %}</label>
                            <div class="col-sm-5">
                              {{form.custom_tl_frame_delimiter}}
                              {{form.custom_tl_frame_delimiter.errors|safe}}
                            </div>
                          </div>
                        </div>
                      </div> <!-- /.row log-mode listening-tcp -->
                      <div class="row log-mode listening-tcp">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{% translate "Rate-limiting interval" %}</label>
                            <div class="col-sm-5">
                              {{form.ratelimit_interval}}
                              {{form.ratelimit_interval.errors|safe}}
                            </div>
                            <div class="col-sm-2">
                              {% translate " s" %}
                            </div>
                          </div>
                        </div>
                      </div> <!-- /.row log-mode listening-tcp -->
                      <div class="row log-mode listening-tcp">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{% translate "Rate-limiting burst" %}</label>
                            <div class="col-sm-5">
                              {{form.ratelimit_burst}}
                              {{form.ratelimit_burst.errors|safe}}
                            </div>
                          </div>
                        </div>
                      </div> <!-- /.row log-mode listening-tcp -->
                      <div class="row log-mode filebeat-mode">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{{form.expected_timezone.label}}</label>
                            <div class="col-sm-5">
                              {{form.expected_timezone}}
                              {{form.expected_timezone.errors|safe}}
                            </div>
                          </div>
                        </div>
                      </div> <!-- /.row log-mode filebeat-mode -->
                    </div> <!-- /advanced_options -->
                  </div> <!-- /.tab-pane tab_general -->
                  <div class="tab-pane" id="tab_network">

                    <div class="panel-heading">
                      <div class="panel-control">
                        <a class="btn btn-flat btn-primary" id="add_listener"><i class="fa fa-plus-circle">&nbsp;</i>Add an entry</a>
                      </div>
                    </div>
                    <div class="row http-mode tcp-mode log-mode filebeat-mode">
                      <div class="col-md-12">
                        <table id="listener_table" class="table table-striped table-bordered table-hover dt-responsive nowrap table-datatable">
                          <!-- Here are the attributes of Listener class -->
                          <thead>
                            <tr>
                              <th style="visibility:hidden;">Id</th>
                              <th>{% translate "Listen Address(es)" %}</th>
                              <th>{% translate "Port" %}</th>
                              <th>{% translate "TLS Profile" %}</th>
                              <th>{% translate "Allow from" %}</th>
                              <th>{% translate "Max src" %}</th>
                              <th>{% translate "Max rate" %}</th>
                              <th>{% translate "Delete" %}</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for l in listeners %}
                              {{ l.as_table_td|safe }}
                            {% endfor %}
                          </tbody>
                        </table>
                        {{ form.listeners.errors|safe }}
                        <input id="listeners" name="listeners" value="" type="hidden">
                      </div>
                    </div>

                    <fieldset class="col-lg-12 sol-sm-12 haproxy-conf">
                      <legend>{% translate "Timeout options" %}</legend>
                      <div class="row tcp-mode haproxy-conf">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{% translate "Timeout client" %}</label>
                            <div class="col-sm-5">
                              {{form.timeout_client}}
                              {{form.timeout_client.errors|safe}}
                            </div>
                            <div class="col-sm-2">
                              {% translate " s" %}
                            </div>
                          </div>
                        </div>
                      </div> <!-- /.row -->
                      <div class="row http-mode">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-4 control-label">{{form.timeout_keep_alive.label}}</label>
                            <div class="col-sm-5">
                              {{form.timeout_keep_alive}}
                              {{form.timeout_keep_alive.errors|safe}}
                            </div>
                            <div class="col-sm-2">
                              {% translate " ms" %}
                            </div>
                          </div>
                        </div>
                      </div> <!-- /.row -->
                    </fieldset>
                  </div> <!-- /.tab-pane tab_network -->
                  <div class="tab-pane" id="tab_http">
                    <div class="row http-mode">
                     <div class="col-md-12">
                      <div class="form-group">
                        <label class="col-sm-4 control-label">{{form.https_redirect.label}}</label>
                        <div class="col-md-5">
                          {{form.https_redirect}}
                          {{form.https_redirect.errors|safe}}
                        </div>
                      </div>
                     </div>
                    </div>
                    <div class="row http-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Enable cache" %}</label>
                          <div class="col-sm-5">
                            {{form.enable_cache}}
                            {{form.enable_cache.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row http-mode -->
                    <div class="row http-mode cache">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Cache total max size (Mb)" %}</label>
                          <div class="col-sm-5">
                            {{form.cache_total_max_size}}
                            {{form.cache_total_max_size.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row http-mode cache -->
                    <div class="row http-mode cache">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Cache max age (seconds)" %}</label>
                          <div class="col-sm-5">
                            {{form.cache_max_age}}
                            {{form.cache_max_age.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row http-mode cache -->
                    <div class="row http-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Enable compression" %}</label>
                          <div class="col-sm-5">
                            {{form.enable_compression}}
                            {{form.enable_compression.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row http-mode -->
                    <div class="row http-mode compression">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Supported compression algorithms" %}</label>
                          <div class="col-sm-5">
                            {{form.compression_algos}}
                            {{form.compression_algos.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row http-mode compression -->
                    <div class="row http-mode compression">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "MIME types compressed" %}</label>
                          <div class="col-sm-5">
                            {{form.compression_mime_types}}
                            {{form.compression_mime_types.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row http-mode compression -->
                    <div class="row http-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Error template" %}</label>
                          <div class="col-sm-5">
                            {{form.error_template}}
                            {{form.error_template.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row http-mode -->
                  </div> <!-- /.tab-pane tab_http -->
                  <div class="tab-pane" id="tab_headers">
                    <div class="row http-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Headers" %}</label>
                        </div>
                        <table id="header_table" class="table table-striped table-bordered table-hover dt-responsive nowrap table-datatable">
                          <thead>
                            {{header_form.as_table_headers|safe}}
                          </thead>
                          <tbody>
                            {% for h in headers %}
                              {{ h.as_table_td|safe }}
                            {% endfor %}
                          </tbody>
                        </table>
                        <div style="text-align:right;margin-top:10px;">
                          <div class="add-group">
                            <button class="addplus addlink" id="add_header" type="button">{% translate "Add an Entry" %}</button>
                          </div>
                        </div>
                        {{ form.headers.errors|safe }}
                        <input id="headers" name="headers" value="" type="hidden">
                      </div>
                    </div>
                  </div> <!-- /.tab-pane tab_headers -->
                  <div class="tab-pane" id="tab_logging">
                    <div class="row logging">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{form.log_forwarders.label}}</label>
                          <div class="col-sm-5">
                            {{form.log_forwarders}}
                            {{form.log_forwarders.errors|safe}}
                          </div>
                        </div>
                      </div>
                      <div class="col-md-12 log-failure">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{{form.log_forwarders_parse_failure.label}}</label>
                          <div class="col-sm-5">
                            {{form.log_forwarders_parse_failure}}
                            {{form.log_forwarders_parse_failure.errors|safe}}
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-4 pull-right">
                        <div class="form-group">
                          <button class="btn btn-box-tool" type="button" data-toggle="collapse" data-target=".browsers-compat">
                            <i class="fa fa-plus"></i> {% translate "Advanced" %}
                          </button>
                        </div>
                      </div>
                    </div> <!-- /.row logging -->
                    <div class="row logging">
                      <div class="col-md-12 log-parser-json">
                        <div class="form-group collapse browsers-compat">
                          <legend>{% translate "Rename fields (only on json source)" %}</legend>
                          <table id="keep_source_fields_table" class="table table-striped table-bordered table-hover dt-responsive nowrap table-datatable">
                            <!-- Here are the attributes of Listener class -->
                            <thead>
                              <tr>
                                <th>{% translate "Origin field" %}</th>
                                <th>{% translate "New field" %}</th>
                                <th>{% translate "Keep source" %}</th>
                                <th>{% translate "Delete" %}</th>
                              </tr>
                            </thead>
                            <tbody>
                              {% for key,val in form.keep_source_fields.initial.items %}
                                <tr>
                                  <td><input type="text" value="{{ val.field_name }}"/></td>
                                  <td><input type="text" value="{{ key }}"/></td>
                                  <td style="text-align:center"><input type="checkbox" {% if val.keep_source %}checked{% endif %}/></td>
                                  <td style="text-align:center"><a class="btnDelete"><i style="color:grey" class="fas fa-trash-alt"></i></a></td>
                                </tr>
                              {% endfor %}
                            </tbody>
                          </table>
                          {{ form.keep_source_fields.errors|safe }}
                          <a class="btn btn-flat btn-primary" id="add_keep_source_field"><i class="fa fa-plus-circle">&nbsp;</i>Add an entry</a>
                          <input id="keep_source_fields" name="keep_source_fields" value="{{form.keep_source_fields.initial}}" type="hidden">
                        </div>
                      </div>
                    </div>
                    <div class="row logging">
                      <div class="col-md-12">
                        <div class="form-group collapse browsers-compat">
                          <table id="log_forwarders_table" class="table table-striped table-bordered table-hover dt-responsive nowrap table-datatable">
                            <thead>
                              {{ log_om_table.as_table_headers|safe }}
                            </thead>
                            <tbody>
                            {{ log_om_table.as_table_td|safe }}
                            </tbody>
                          </table>
                          <div style="text-align:right;margin-top:10px;">
                            <div class="add-group">
                              <button class="addplus addlink" id="add_log_fwd_entry" data-id="request_data_get" type="button">{% translate "Add an Entry" %}</button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row logging">
                      <div class="col-md-12">
                        <div class="form-group collapse browsers-compat">
                          <label class="col-sm-4 control-label">{% translate "Logging conditions" %}</label>
                          <div class="col-sm-5">
                            {{form.log_condition}}
                            {{form.log_condition.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div> <!-- /.tab-pane tab_logging -->
                  <div class="tab-pane" id="tab_enrichment">
                    <div class="row logging http-mode-logging">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Tenants config" %}</label>
                          <div class="col-sm-5">
                            {{form.tenants_config}}
                            {{form.tenants_config.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row logging http-mode-logging -->
                    <div class="row logging http-mode-logging">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Enable reputation logging" %}</label>
                          <div class="col-sm-5">
                            {{form.enable_logging_reputation}}
                            {{form.enable_logging_reputation.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row logging http-mode-logging -->
                    <div class="row reputation-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Reputation database IPv4" %}</label>
                          <div class="col-sm-5">
                            {{form.logging_reputation_database_v4}}
                            {{form.logging_reputation_database_v4.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row reputation-mode -->
                    <div class="row reputation-mode">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Reputation database IPv6" %}</label>
                          <div class="col-sm-5">
                            {{form.logging_reputation_database_v6}}
                            {{form.logging_reputation_database_v6.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row reputation-mode -->
                    <div class="row logging http-mode-logging">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-4 control-label">{% translate "Geoip database (v4 & v6)" %}</label>
                          <div class="col-sm-5">
                            {{form.logging_geoip_database}}
                            {{form.logging_geoip_database.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div> <!-- /.row logging http-mode-logging -->
                    <div class="row logging">
                      {% if not reputationctx_form.reputation_ctx.field.choices %}
                        <a class="btn btn-flat btn-primary" href="{% url 'applications.reputation_ctx.edit' %}">
                          <i class="fa fa-plus-circle">&nbsp;
                          </i>
                          {% translate "No custom tags for now, create a new <b>Custom tags</b> object." %}
                        </a>
                      {% else %}
                        <div class="col-md-12">
                          <div class="form-group">
                            <table id="reputationctx_table" class="table table-striped table-bordered table-hover dt-responsive nowrap table-datatable">
                              <thead>
                                {{ reputationctx_form.as_table_headers|safe }}
                              </thead>
                              <tbody>
                              {% for reputationctx in reputation_contexts %}
                                {{ reputationctx.as_table_td|safe }}
                              {% endfor %}
                              </tbody>
                            </table>
                            <div style="text-align:right;margin-top:10px;">
                              <div class="add-group">
                                <button class="addplus addlink" id="add_reputationctx_entry" data-id="request_data_get" type="button">{% translate "Add an Entry" %}</button>
                              </div>
                            </div>
                            {{ form.reputation_ctx.errors|safe }}
                            <input id="reputation_contexts" name="reputation_contexts" value="" type="hidden">
                          </div>
                        </div>
                      {% endif %}
                    </div>
                  </div> <!-- /.tab-pane tab_enrichment -->
                  <div class="tab-pane" id="tab_custom_rsyslog">
                    {{ form.custom_actions }}
                    {{ form.custom_actions.errors|safe }}
                    {% include "custom_actions.html" %}
                  </div> <!-- /.tab-pane tab_custom_rsyslog -->
                  <div class="tab-pane" id="tab_custom_haproxy">
                    <div class="row haproxy-conf">
                      <div class="col-md-12">
                        <div class="form-group">
                          <label class="col-sm-3 control-label">{% translate "HAProxy Frontend Config" %}</label>
                          <div class="col-sm-8">
                            {{form.custom_haproxy_conf}}
                            {{form.custom_haproxy_conf.errors|safe}}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div> <!-- /.tab-pane tab_custom_haproxy -->
                  <div class="tab-pane" id="tab_log_settings">
                    <div class="row">
                      <div class="col-md-12 api-mode">
                        <div class="form-group">
                          <label class="col-sm-3 control-label">{% translate "API Parser Type" %}</label>
                          <div class="col-sm-5">
                            {{ form.api_parser_type }}
                            {{ form.api_parser_type.errors|safe }}
                          </div>
                        </div>
                      </div>
                      <div class="col-md-12 api-mode filebeat-mode">
                        <div class="form-group">
                          <label class="col-sm-3 control-label">{% translate "Use proxy" %}</label>
                          <div class="col-sm-5">
                            {{ form.api_parser_use_proxy }}
                            {{ form.api_parser_use_proxy.errors|safe }}
                          </div>
                        </div>
                      </div>
                      <div class="col-md-12" id="api_parser_custom_proxy">
                        <div class="form-group">
                          <label class="col-sm-3 control-label">{{ form.api_parser_custom_proxy.label }}</label>
                          <div class="col-sm-5">
                            {{ form.api_parser_custom_proxy }}
                            {{ form.api_parser_custom_proxy.errors|safe }}
                          </div>
                        </div>
                      </div>
                      <div class="api-mode">
                        <div class="col-md-12">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.api_parser_verify_ssl.label }}</label>
                            <div class="col-sm-5">
                              {{ form.api_parser_verify_ssl }}
                              {{ form.api_parser_verify_ssl.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12" id="api_parser_custom_certificate">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.api_parser_custom_certificate.label }}</label>
                            <div class="col-sm-5">
                              {{form.api_parser_custom_certificate}}
                              {{form.api_parser_custom_certificate.errors|safe}}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_office_365_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.office365_tenant_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.office365_tenant_id }}
                              {{ form.office365_tenant_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.office365_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.office365_client_id }}
                              {{ form.office365_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.office365_client_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.office365_client_secret }}
                              {{ form.office365_client_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_akamai_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.akamai_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.akamai_host }}
                              {{ form.akamai_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.akamai_config_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.akamai_config_id }}
                              {{ form.akamai_config_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.akamai_client_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.akamai_client_secret }}
                              {{ form.akamai_client_secret.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.akamai_access_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.akamai_access_token }}
                              {{ form.akamai_access_token.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.akamai_client_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.akamai_client_token }}
                              {{ form.akamai_client_token.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_forcepoint_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.forcepoint_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.forcepoint_host }}
                              {{ form.forcepoint_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.forcepoint_username.label }}</label>
                            <div class="col-sm-5">
                              {{ form.forcepoint_username }}
                              {{ form.forcepoint_username.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.forcepoint_password.label }}</label>
                            <div class="col-sm-5">
                              {{ form.forcepoint_password }}
                              {{ form.forcepoint_password.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_imperva_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.imperva_base_url.label }}</label>
                            <div class="col-sm-5">
                              {{ form.imperva_base_url }}
                              {{ form.imperva_base_url.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.imperva_api_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.imperva_api_key }}
                              {{ form.imperva_api_key.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.imperva_api_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.imperva_api_id }}
                              {{ form.imperva_api_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.imperva_private_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.imperva_private_key }}
                              {{ form.imperva_private_key.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_symantec_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.symantec_username.label }}</label>
                            <div class="col-sm-5">
                              {{ form.symantec_username }}
                              {{ form.symantec_username.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.symantec_password.label }}</label>
                            <div class="col-sm-5">
                              {{ form.symantec_password }}
                              {{ form.symantec_password.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_reachfive_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.reachfive_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.reachfive_host }}
                              {{ form.reachfive_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.reachfive_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.reachfive_client_id }}
                              {{ form.reachfive_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.reachfive_client_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.reachfive_client_secret }}
                              {{ form.reachfive_client_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_mongodb_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.mongodb_api_user.label }}</label>
                            <div class="col-sm-5">
                              {{ form.mongodb_api_user }}
                              {{ form.mongodb_api_user.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.mongodb_api_password.label }}</label>
                            <div class="col-sm-5">
                              {{ form.mongodb_api_password }}
                              {{ form.mongodb_api_password.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.mongodb_api_group_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.mongodb_api_group_id }}
                              {{ form.mongodb_api_group_id.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_defender_atp_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.mdatp_api_tenant.label }}</label>
                            <div class="col-sm-5">
                              {{ form.mdatp_api_tenant }}
                              {{ form.mdatp_api_tenant.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.mdatp_api_appid.label }}</label>
                            <div class="col-sm-5">
                              {{ form.mdatp_api_appid }}
                              {{ form.mdatp_api_appid.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.mdatp_api_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.mdatp_api_secret }}
                              {{ form.mdatp_api_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_cortex_xdr_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cortex_xdr_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cortex_xdr_host }}
                              {{ form.cortex_xdr_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cortex_xdr_apikey_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cortex_xdr_apikey_id }}
                              {{ form.cortex_xdr_apikey_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cortex_xdr_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cortex_xdr_apikey }}
                              {{ form.cortex_xdr_apikey.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cortex_xdr_advanced_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cortex_xdr_advanced_token }}
                              {{ form.cortex_xdr_advanced_token.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_cisco_meraki_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_meraki_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_meraki_apikey }}
                              {{ form.cisco_meraki_apikey.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_meraki_get_security_logs.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_meraki_get_security_logs }}
                              {{ form.cisco_meraki_get_security_logs.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_meraki_get_configuration_changes_logs.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_meraki_get_configuration_changes_logs }}
                              {{ form.cisco_meraki_get_configuration_changes_logs.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_cybereason_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cybereason_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cybereason_host }}
                              {{ form.cybereason_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cybereason_username.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cybereason_username }}
                              {{ form.cybereason_username.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cybereason_password.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cybereason_password }}
                              {{ form.cybereason_password.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_aws_bucket_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.aws_access_key_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.aws_access_key_id }}
                              {{ form.aws_access_key_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.aws_secret_access_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.aws_secret_access_key }}
                              {{ form.aws_secret_access_key.errors|safe }}
                            </div>
                          </div>

                          <div class="text-center mar-btm">
                            <button class="btn btn-primary fetch_data_api_parser" data-target="id_aws_bucket_name" data-type="select" type="button">
                              {% translate "Fetch buckets name" %}
                            </button>
                          </div>

                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.aws_bucket_name.label }}</label>
                            <div class="col-sm-5">
                              {{ form.aws_bucket_name }}
                              {{ form.aws_bucket_name.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_proofpoint_tap_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_tap_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_tap_host }}
                              {{ form.proofpoint_tap_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_tap_endpoint.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_tap_endpoint }}
                              {{ form.proofpoint_tap_endpoint.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_tap_principal.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_tap_principal }}
                              {{ form.proofpoint_tap_principal.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_tap_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_tap_secret }}
                              {{ form.proofpoint_tap_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_sentinel_one_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sentinel_one_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sentinel_one_host }}
                              {{ form.sentinel_one_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sentinel_one_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sentinel_one_apikey }}
                              {{ form.sentinel_one_apikey.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sentinel_one_account_type.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sentinel_one_account_type }}
                              {{ form.sentinel_one_account_type.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_carbon_black_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.carbon_black_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.carbon_black_host }}
                              {{ form.carbon_black_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.carbon_black_orgkey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.carbon_black_orgkey }}
                              {{ form.carbon_black_orgkey.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.carbon_black_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.carbon_black_apikey }}
                              {{ form.carbon_black_apikey.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_rapid7_idr_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.rapid7_idr_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.rapid7_idr_host }}
                              {{ form.rapid7_idr_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.rapid7_idr_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.rapid7_idr_apikey }}
                              {{ form.rapid7_idr_apikey.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_harfanglab_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.harfanglab_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.harfanglab_host }}
                              {{ form.harfanglab_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.harfanglab_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.harfanglab_apikey }}
                              {{ form.harfanglab_apikey.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_vadesecure_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.vadesecure_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.vadesecure_host }}
                              {{ form.vadesecure_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.vadesecure_login.label }}</label>
                            <div class="col-sm-5">
                              {{ form.vadesecure_login }}
                              {{ form.vadesecure_login.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.vadesecure_password.label }}</label>
                            <div class="col-sm-5">
                              {{ form.vadesecure_password }}
                              {{ form.vadesecure_password.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_nozomi_probe_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.nozomi_probe_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.nozomi_probe_host }}
                              {{ form.nozomi_probe_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.nozomi_probe_login.label }}</label>
                            <div class="col-sm-5">
                              {{ form.nozomi_probe_login }}
                              {{ form.nozomi_probe_login.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.nozomi_probe_password.label }}</label>
                            <div class="col-sm-5">
                              {{ form.nozomi_probe_password }}
                              {{ form.nozomi_probe_password.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_netskope_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.netskope_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.netskope_host }}
                              {{ form.netskope_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.netskope_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.netskope_apikey }}
                              {{ form.netskope_apikey.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.netskope_get_page_logs.label }}</label>
                            <div class="col-sm-5">
                              {{ form.netskope_get_page_logs }}
                              {{ form.netskope_get_page_logs.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.netskope_get_network_logs.label }}</label>
                            <div class="col-sm-5">
                              {{ form.netskope_get_network_logs }}
                              {{ form.netskope_get_network_logs.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.netskope_get_application_logs.label }}</label>
                            <div class="col-sm-5">
                              {{ form.netskope_get_application_logs }}
                              {{ form.netskope_get_application_logs.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_defender_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.defender_token_endpoint.label }}</label>
                            <div class="col-sm-5">
                              {{ form.defender_token_endpoint }}
                              {{ form.defender_token_endpoint.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.defender_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.defender_client_id }}
                              {{ form.defender_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.defender_client_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.defender_client_secret }}
                              {{ form.defender_client_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_crowdstrike_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.crowdstrike_request_incidents.label }}</label>
                            <div class="col-sm-5">
                              {{ form.crowdstrike_request_incidents }}
                              {{ form.crowdstrike_request_incidents.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.crowdstrike_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.crowdstrike_host }}
                              {{ form.crowdstrike_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.crowdstrike_client.label }}</label>
                            <div class="col-sm-5">
                              {{ form.crowdstrike_client }}
                              {{ form.crowdstrike_client.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.crowdstrike_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.crowdstrike_client_id }}
                              {{ form.crowdstrike_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.crowdstrike_client_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.crowdstrike_client_secret }}
                              {{ form.crowdstrike_client_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_vadesecure_o365_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.vadesecure_o365_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.vadesecure_o365_host }}
                              {{ form.vadesecure_o365_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.vadesecure_o365_tenant.label }}</label>
                            <div class="col-sm-5">
                              {{ form.vadesecure_o365_tenant }}
                              {{ form.vadesecure_o365_tenant.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.vadesecure_o365_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.vadesecure_o365_client_id }}
                              {{ form.vadesecure_o365_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.vadesecure_o365_client_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.vadesecure_o365_client_secret }}
                              {{ form.vadesecure_o365_client_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_ms_sentinel_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.ms_sentinel_tenant_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.ms_sentinel_tenant_id }}
                              {{ form.ms_sentinel_tenant_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.ms_sentinel_appid.label }}</label>
                            <div class="col-sm-5">
                              {{ form.ms_sentinel_appid }}
                              {{ form.ms_sentinel_appid.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.ms_sentinel_appsecret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.ms_sentinel_appsecret }}
                              {{ form.ms_sentinel_appsecret.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.ms_sentinel_subscription_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.ms_sentinel_subscription_id }}
                              {{ form.ms_sentinel_subscription_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.ms_sentinel_resource_group.label }}</label>
                            <div class="col-sm-5">
                              {{ form.ms_sentinel_resource_group }}
                              {{ form.ms_sentinel_resource_group.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.ms_sentinel_workspace.label }}</label>
                            <div class="col-sm-5">
                              {{ form.ms_sentinel_workspace }}
                              {{ form.ms_sentinel_workspace.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_waf_cloudflare_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.waf_cloudflare_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.waf_cloudflare_apikey }}
                              {{ form.waf_cloudflare_apikey.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.waf_cloudflare_zoneid.label }}</label>
                            <div class="col-sm-5">
                              {{ form.waf_cloudflare_zoneid }}
                              {{ form.waf_cloudflare_zoneid.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_sophos_cloud_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sophos_cloud_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sophos_cloud_client_id }}
                              {{ form.sophos_cloud_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sophos_cloud_client_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sophos_cloud_client_secret }}
                              {{ form.sophos_cloud_client_secret.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sophos_cloud_tenant_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sophos_cloud_tenant_id }}
                              {{ form.sophos_cloud_tenant_id.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_blackberry_cylance_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.blackberry_cylance_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.blackberry_cylance_host }}
                              {{ form.blackberry_cylance_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.blackberry_cylance_tenant.label }}</label>
                            <div class="col-sm-5">
                              {{ form.blackberry_cylance_tenant }}
                              {{ form.blackberry_cylance_tenant.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.blackberry_cylance_app_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.blackberry_cylance_app_id }}
                              {{ form.blackberry_cylance_app_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.blackberry_cylance_app_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.blackberry_cylance_app_secret }}
                              {{ form.blackberry_cylance_app_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_proofpoint_pod_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_pod_uri.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_pod_uri }}
                              {{ form.proofpoint_pod_uri.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_pod_cluster_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_pod_cluster_id }}
                              {{ form.proofpoint_pod_cluster_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_pod_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_pod_token }}
                              {{ form.proofpoint_pod_token.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_gsuite_alertcenter_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.gsuite_alertcenter_json_conf.label }}</label>
                            <div class="col-sm-5">
                              {{ form.gsuite_alertcenter_json_conf }}
                              {{ form.gsuite_alertcenter_json_conf.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.gsuite_alertcenter_admin_mail.label }}</label>
                            <div class="col-sm-5">
                              {{ form.gsuite_alertcenter_admin_mail }}
                              {{ form.gsuite_alertcenter_admin_mail.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_trendmicro_worryfree_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.trendmicro_worryfree_access_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.trendmicro_worryfree_access_token }}
                              {{ form.trendmicro_worryfree_access_token.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.trendmicro_worryfree_secret_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.trendmicro_worryfree_secret_key }}
                              {{ form.trendmicro_worryfree_secret_key.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                              <label class="col-sm-3 control-label">{{ form.trendmicro_worryfree_server_name.label }}</label>
                            <div class="col-sm-5">
                              {{ form.trendmicro_worryfree_server_name }}
                              {{ form.trendmicro_worryfree_server_name.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.trendmicro_worryfree_server_port.label }}</label>
                            <div class="col-sm-5">
                              {{ form.trendmicro_worryfree_server_port }}
                              {{ form.trendmicro_worryfree_server_port.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_safenet_row">
                          <div class="form-group">
                              <label class="col-sm-3 control-label">{{ form.safenet_tenant_code.label }}</label>
                            <div class="col-sm-5">
                              {{ form.safenet_tenant_code }}
                              {{ form.safenet_tenant_code.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.safenet_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.safenet_apikey }}
                              {{ form.safenet_apikey.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_signalsciences_ngwaf_row">
                          <div class="form-group">
                              <label class="col-sm-3 control-label">{{ form.signalsciences_ngwaf_email.label }}</label>
                            <div class="col-sm-5">
                              {{ form.signalsciences_ngwaf_email }}
                              {{ form.signalsciences_ngwaf_email.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.signalsciences_ngwaf_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.signalsciences_ngwaf_token }}
                              {{ form.signalsciences_ngwaf_token.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.signalsciences_ngwaf_corp_name.label }}</label>
                            <div class="col-sm-5">
                              {{ form.signalsciences_ngwaf_corp_name }}
                              {{ form.signalsciences_ngwaf_corp_name.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.signalsciences_ngwaf_site_name.label }}</label>
                            <div class="col-sm-5">
                              {{ form.signalsciences_ngwaf_site_name }}
                              {{ form.signalsciences_ngwaf_site_name.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_proofpoint_casb_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_casb_api_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_casb_api_key }}
                              {{ form.proofpoint_casb_api_key.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_casb_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_casb_client_id }}
                              {{ form.proofpoint_casb_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_casb_client_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_casb_client_secret }}
                              {{ form.proofpoint_casb_client_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_proofpoint_trap_row">
                          <div class="form-group">
                              <label class="col-sm-3 control-label">{{ form.proofpoint_trap_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_trap_host }}
                              {{ form.proofpoint_trap_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.proofpoint_trap_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.proofpoint_trap_apikey }}
                              {{ form.proofpoint_trap_apikey.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_waf_cloud_protector_row">
                          <div class="form-group">
                              <label class="col-sm-3 control-label">{{ form.waf_cloud_protector_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.waf_cloud_protector_host }}
                              {{ form.waf_cloud_protector_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.waf_cloud_protector_api_key_pub.label }}</label>
                            <div class="col-sm-5">
                              {{ form.waf_cloud_protector_api_key_pub }}
                              {{ form.waf_cloud_protector_api_key_pub.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.waf_cloud_protector_api_key_priv.label }}</label>
                            <div class="col-sm-5">
                              {{ form.waf_cloud_protector_api_key_priv }}
                              {{ form.waf_cloud_protector_api_key_priv.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.waf_cloud_protector_provider.label }}</label>
                            <div class="col-sm-5">
                              {{ form.waf_cloud_protector_provider }}
                              {{ form.waf_cloud_protector_provider.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.waf_cloud_protector_tenant.label }}</label>
                            <div class="col-sm-5">
                              {{ form.waf_cloud_protector_tenant }}
                              {{ form.waf_cloud_protector_tenant.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.waf_cloud_protector_servers.label }}</label>
                            <div class="col-sm-5">
                              {{ form.waf_cloud_protector_servers }}
                              {{ form.waf_cloud_protector_servers.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_trendmicro_visionone_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.trendmicro_visionone_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.trendmicro_visionone_token }}
                              {{ form.trendmicro_visionone_token.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_cisco_duo_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_duo_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_duo_host }}
                              {{ form.cisco_duo_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_duo_ikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_duo_ikey }}
                              {{ form.cisco_duo_ikey.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_duo_skey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_duo_skey }}
                              {{ form.cisco_duo_skey.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_sentinel_one_mobile_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sentinel_one_mobile_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sentinel_one_mobile_host }}
                              {{ form.sentinel_one_mobile_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sentinel_one_mobile_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sentinel_one_mobile_apikey }}
                              {{ form.sentinel_one_mobile_apikey.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_sentinel_one_singularity_mobile_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sentinel_one_singularity_mobile_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sentinel_one_singularity_mobile_host }}
                              {{ form.sentinel_one_singularity_mobile_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sentinel_one_singularity_mobile_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sentinel_one_singularity_mobile_client_id }}
                              {{ form.sentinel_one_singularity_mobile_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sentinel_one_singularity_mobile_client_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sentinel_one_singularity_mobile_client_secret }}
                              {{ form.sentinel_one_singularity_mobile_client_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_csc_domainmanager_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.csc_domainmanager_apikey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.csc_domainmanager_apikey }}
                              {{ form.csc_domainmanager_apikey.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.csc_domainmanager_authorization.label }}</label>
                            <div class="col-sm-5">
                              {{ form.csc_domainmanager_authorization }}
                              {{ form.csc_domainmanager_authorization.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_retarus_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.retarus_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.retarus_token }}
                              {{ form.retarus_token.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.retarus_channel.label }}</label>
                            <div class="col-sm-5">
                              {{ form.retarus_channel }}
                              {{ form.retarus_channel.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_vectra_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.vectra_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.vectra_host }}
                              {{ form.vectra_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.vectra_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.vectra_client_id }}
                              {{ form.vectra_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.vectra_secret_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.vectra_secret_key }}
                              {{ form.vectra_secret_key.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_apex_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.apex_server_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.apex_server_host }}
                              {{ form.apex_server_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.apex_api_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.apex_api_key }}
                              {{ form.apex_api_key.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.apex_application_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.apex_application_id }}
                              {{ form.apex_application_id.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_gatewatcher_alerts_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.gatewatcher_alerts_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.gatewatcher_alerts_host }}
                              {{ form.gatewatcher_alerts_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.gatewatcher_alerts_api_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.gatewatcher_alerts_api_key }}
                              {{ form.gatewatcher_alerts_api_key.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_cisco_umbrella_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_umbrella_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_umbrella_client_id }}
                              {{ form.cisco_umbrella_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_umbrella_secret_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_umbrella_secret_key }}
                              {{ form.cisco_umbrella_secret_key.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_waf_barracuda_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.waf_barracuda_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.waf_barracuda_token }}
                              {{ form.waf_barracuda_token.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_beyondtrust_pra_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.beyondtrust_pra_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.beyondtrust_pra_client_id }}
                              {{ form.beyondtrust_pra_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.beyondtrust_pra_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.beyondtrust_pra_secret }}
                              {{ form.beyondtrust_pra_secret.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.beyondtrust_pra_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.beyondtrust_pra_host }}
                              {{ form.beyondtrust_pra_host.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_lockself_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.lockself_x_ls_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.lockself_x_ls_token }}
                              {{ form.lockself_x_ls_token.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.lockself_x_auth_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.lockself_x_auth_token }}
                              {{ form.lockself_x_auth_token.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.lockself_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.lockself_host }}
                              {{ form.lockself_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.lockself_organization_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.lockself_organization_id }}
                              {{ form.lockself_organization_id.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_cisco_umbrella_managed_org_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_umbrella_managed_org_api_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_umbrella_managed_org_api_key }}
                              {{ form.cisco_umbrella_managed_org_api_key.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_umbrella_managed_org_secret_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_umbrella_managed_org_secret_key }}
                              {{ form.cisco_umbrella_managed_org_secret_key.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_umbrella_managed_org_customers_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_umbrella_managed_org_customers_id }}
                              {{ form.cisco_umbrella_managed_org_customers_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_umbrella_managed_org_get_dns.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_umbrella_managed_org_get_dns }}
                              {{ form.cisco_umbrella_managed_org_get_dns.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.cisco_umbrella_managed_org_get_proxy.label }}</label>
                            <div class="col-sm-5">
                              {{ form.cisco_umbrella_managed_org_get_proxy }}
                              {{ form.cisco_umbrella_managed_org_get_proxy.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_catonetworks_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.catonetworks_api_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.catonetworks_api_key }}
                              {{ form.catonetworks_api_key.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.catonetworks_account_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.catonetworks_account_id }}
                              {{ form.catonetworks_account_id.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_infoblox_threat_defense_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.infoblox_threat_defense_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.infoblox_threat_defense_host }}
                              {{ form.infoblox_threat_defense_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.infoblox_threat_defense_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.infoblox_threat_defense_token }}
                              {{ form.infoblox_threat_defense_token.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_beyondtrust_reportings_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.beyondtrust_reportings_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.beyondtrust_reportings_client_id }}
                              {{ form.beyondtrust_reportings_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.beyondtrust_reportings_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.beyondtrust_reportings_secret }}
                              {{ form.beyondtrust_reportings_secret.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.beyondtrust_reportings_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.beyondtrust_reportings_host }}
                              {{ form.beyondtrust_reportings_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.beyondtrust_reportings_get_team_logs.label }}</label>
                            <div class="col-sm-5">
                              {{ form.beyondtrust_reportings_get_team_logs }}
                              {{ form.beyondtrust_reportings_get_team_logs.errors|safe }}
                            </div>
                          </div>
                            <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.beyondtrust_reportings_get_access_session_logs.label }}</label>
                            <div class="col-sm-5">
                              {{ form.beyondtrust_reportings_get_access_session_logs }}
                              {{ form.beyondtrust_reportings_get_access_session_logs.errors|safe }}
                            </div>
                          </div>
                            <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.beyondtrust_reportings_get_vault_account_activity_logs.label }}</label>
                            <div class="col-sm-5">
                              {{ form.beyondtrust_reportings_get_vault_account_activity_logs }}
                              {{ form.beyondtrust_reportings_get_vault_account_activity_logs.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.beyondtrust_reportings_get_support_session_logs.label }}</label>
                            <div class="col-sm-5">
                              {{ form.beyondtrust_reportings_get_support_session_logs }}
                              {{ form.beyondtrust_reportings_get_support_session_logs.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_varonis_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.varonis_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.varonis_host }}
                              {{ form.varonis_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.varonis_api_key.label }}</label>
                            <div class="col-sm-5">
                              {{ form.varonis_api_key }}
                              {{ form.varonis_api_key.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_armis_centrix_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.armis_centrix_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.armis_centrix_host }}
                              {{ form.armis_centrix_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.armis_centrix_secretkey.label }}</label>
                            <div class="col-sm-5">
                              {{ form.armis_centrix_secretkey }}
                              {{ form.armis_centrix_secretkey.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.armis_centrix_get_activity_logs.label }}</label>
                            <div class="col-sm-5">
                              {{ form.armis_centrix_get_activity_logs }}
                              {{ form.armis_centrix_get_activity_logs.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_perception_point_x_ray_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.perception_point_x_ray_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.perception_point_x_ray_host }}
                              {{ form.perception_point_x_ray_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.perception_point_x_ray_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.perception_point_x_ray_token }}
                              {{ form.perception_point_x_ray_token.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.perception_point_x_ray_organization_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.perception_point_x_ray_organization_id }}
                              {{ form.perception_point_x_ray_organization_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.perception_point_x_ray_environment_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.perception_point_x_ray_environment_id }}
                              {{ form.perception_point_x_ray_environment_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.perception_point_x_ray_case_types.label }}</label>
                            <div class="col-sm-5">
                              {{ form.perception_point_x_ray_case_types }}
                              {{ form.perception_point_x_ray_case_types.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_extrahop_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.extrahop_host.label }}</label>
                            <div class="col-sm-5">
                              {{ form.extrahop_host }}
                              {{ form.extrahop_host.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.extrahop_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.extrahop_id }}
                              {{ form.extrahop_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.extrahop_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.extrahop_secret }}
                              {{ form.extrahop_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_hornetsecurity_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.hornetsecurity_app_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.hornetsecurity_app_id }}
                              {{ form.hornetsecurity_app_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.hornetsecurity_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.hornetsecurity_token }}
                              {{ form.hornetsecurity_token.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_ubika_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.ubika_base_refresh_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.ubika_base_refresh_token }}
                              {{ form.ubika_base_refresh_token.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.ubika_namespaces.label }}</label>
                            <div class="col-sm-5">
                              {{ form.ubika_namespaces }}
                              {{ form.ubika_namespaces.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_sentinel_one_graph_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sentinel_one_graph_token.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sentinel_one_graph_token }}
                              {{ form.sentinel_one_graph_token.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.sentinel_one_graph_console_url.label }}</label>
                            <div class="col-sm-5">
                              {{ form.sentinel_one_graph_console_url }}
                              {{ form.sentinel_one_graph_console_url.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12 api_clients_row" id="api_messagetrace_o365_row">
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.messagetrace_o365_tenant_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.messagetrace_o365_tenant_id }}
                              {{ form.messagetrace_o365_tenant_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.messagetrace_o365_client_id.label }}</label>
                            <div class="col-sm-5">
                              {{ form.messagetrace_o365_client_id }}
                              {{ form.messagetrace_o365_client_id.errors|safe }}
                            </div>
                          </div>
                          <div class="form-group">
                            <label class="col-sm-3 control-label">{{ form.messagetrace_o365_client_secret.label }}</label>
                            <div class="col-sm-5">
                              {{ form.messagetrace_o365_client_secret }}
                              {{ form.messagetrace_o365_client_secret.errors|safe }}
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="text-center mar-btm">
                            <button class="btn btn-warning" id="test_api_parser" type="button">
                              {% translate "Test Configuration" %}
                            </button>
                            <input type="hidden" name="api_parser_has_been_tested" id="id_api_parser_has_been_tested" value="{% if object_id %}1{% else %}0{% endif %}"/>
                          </div>
                        </div>
                      </div> <!-- form-group api-mode -->
                    </div> <!-- /.row -->
                  </div> <!-- /.tab-pane tab_log_settings -->
                </div>
              </div>
            </div>
            <div class="panel-footer">
              <a type="button" href="{% url 'services.frontend.list' %}" class="btn btn-flat btn-default">{% translate "Cancel" %}</a>
              <button type="submit" class="btn btn-info btn-flat pull-right">{% translate "Submit" %}</button>
            </div>
          </div>
        </div>
      </div>
    </form>
  </section>

  <div class="modal" id="modal-test-apiparser">
      <div class="modal-dialog">
          <div class="modal-content">
              <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal"><i class="pci-cross pci-circle"></i></button>
                  <h4 class="modal-title">{% translate "API Parser results" %}</h4>
              </div>

              <div class="modal-body" id="modal-test-apiparser-body">

              </div>

              <div class="modal-footer">
                  <button class="btn btn-primary" data-dismiss="modal" type="button">{% translate "Continue" %}</button>
              </div>
          </div>
      </div>
  </div>

{% endblock %}

{% block jquery_code %}
  {% if save_error %}
    notify('error', '{% translate "Error" %}', '{{ save_error.0 }}');
  {% endif %}

  {% if errors %}
    notify('error', '{% translate "Error" %}', '{{ errors }}');
  {% endif %}

  var filebeat_config = {{ filebeat_module_config|safe }};
  var redis_local = {
    server: '{{ form.REDIS_DEFAULT_SERVER|safe }}',
    port: {{ form.REDIS_DEFAULT_PORT|safe }},
    password: '{{ form.REDIS_DEFAULT_PASSWORD|safe }}'
  }

  var header_form_td = `{{header_form.as_table_td|safe}}`
  var listener_form_td = `{{listener_form.as_table_td|safe}}`;
  var log_om_table_td = `{{log_om_table.as_table_td|safe}}`;
  var reputationctx_form_td = `{{reputationctx_form.as_table_td|safe}}`;
  var old_mode = $('id_mode').val();

  var custom_actions = {{ custom_actions.as_json|default:"[]"|safe }};

  var test_frontend_apiparser_uri = "{% url 'services.frontend.test_apiparser' %}";
  var fetch_frontend_api_parser_data_uri = "{% url 'services.frontend.fetch_apiparser_data' %}";
  var api_parser_blacklist = ["cisco_meraki", "defender", "defender_atp", "gsuite_alertcenter", "mongodb",
                              "ms_sentinel", "office_365", "proofpoint_pod", "proofpoint_casb", "safenet",
                              "sophos_cloud", "symantec", "trendmicro_visionone", "waf_cloudflare", "retarus",
                              "vectra", "cisco_umbrella"
                              ];

{% endblock %}
