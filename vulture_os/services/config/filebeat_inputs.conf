#This file is part of Vulture OS.
#

########################## WARNING ###############################
# Don't edit this file, it is automatically generated by Vulture #
########################## WARNING ###############################

{% if frontend.mode == "filebeat" %}
{% if frontend.api_parser_use_proxy %}
# use_system_proxy=yes
{% endif %}

filebeat.inputs:
# Create a 'fake' entry to have at least a working input
- type: unix
  max_message_size: 10MiB
  path: "/var/run/filebeat-input.sock"

{% if frontend.filebeat_module == "_custom" %}
- type: {% if frontend.filebeat_listening_mode == "file" %}log{% else %}{{ frontend.filebeat_listening_mode}}{% endif %}
{{ frontend.generate_filebeat_conf()|indent(2) }}

{% else %}
filebeat.modules:
{{ frontend.generate_filebeat_conf() }}

{% endif %}

output.redis:
  hosts: [ "redis://{{frontend.redis_server}}:{{frontend.redis_port}}"]
  # FIXME: Generate a redis password for the cluster
  # password: "XXX"
  key: "filebeat_{{frontend.tenants_config.id}}_{{frontend.id}}"
  datatype: list
  db: 0
  backoff.init: 1
  backoff.max: 60
  bulk_max_size: 2048
  timeout: 5

{% endif %}
