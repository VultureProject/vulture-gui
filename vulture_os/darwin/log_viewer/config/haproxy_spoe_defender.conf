#This file is part of Vulture OS.
#

########################## WARNING ###############################
# Don't edit this file, it is automatically generated by Vulture #
########################## WARNING ###############################


[mod_defender]

spoe-agent mod-defender-agent-{{id}}
    messages check-request
    option   var-prefix    defender
    timeout  hello         100ms
    timeout  idle          30s
    timeout  processing    15ms
    use-backend spoe-mod-defender-{{id}}

spoe-message check-request
    args src unique-id method path query req.ver req.hdrs_bin req.body
    {% for w in workflows %}
    acl workflow_{{w.id}}_host hdr(host) {{w.fqdn}}
    acl workflow_{{w.id}}_dir path -i -m beg {{w.public_dir}}
    {%endfor%}
    event on-frontend-http-request if {% for w in workflows %}workflow_{{w.id}}_host workflow_{{w.id}}_dir {% if not loop.last%} or {% endif %}{%endfor%}

